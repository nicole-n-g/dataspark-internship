from find_route_type import *
import sys
sys.path.insert(0, '/Users/nicole/Documents/Predicting_trip_routes_and_type/test_bed')

import extract_routes_with_threshold as erwt

from operator import itemgetter
from itertools import groupby
import csv

def read_csv(csvfilename):
    """
    Reads a csv file and returns a list of list
    containing rows in the csv file and its entries.
    """
    rows = []

    with open(csvfilename, "rU") as csvfile:
        file_reader = csv.reader(csvfile)
        for row in file_reader:
            rows.append(row)
    return rows

def point_in_time_ranges(traffic_infrastructure_by_time_range, point):
    for time_ranges in traffic_infrastructure_by_time_range:
        if point[0][0] >= time_ranges["start_time"] and point[0][0] <= time_ranges["end_time"]:
            return True
    return False

def save_transport_mode_info(times_containing_infra, line_or_service_no, times_containing_infra_indexes, route_length, mrt_lrt_stations, expressways, traffic_infrastructure_by_time):
    result = {}
    first_point_tags = traffic_infrastructure_by_time[times_containing_infra_indexes[0]][1]
    middle_points_tags = []
    for i in times_containing_infra_indexes[1:-1]:
        middle_points_tags.extend(traffic_infrastructure_by_time[i][1])
    last_point_tags = traffic_infrastructure_by_time[times_containing_infra_indexes[-1]][1]
    traffic_infrastructure_by_time = traffic_infrastructure_by_time[times_containing_infra_indexes[0]:times_containing_infra_indexes[-1]+1]
    all_tags_within_range = []
    for i in traffic_infrastructure_by_time:
        all_tags_within_range.extend(i[1])
    result["start_time"] = times_containing_infra[0]
    result["end_time"] = times_containing_infra[-1]
    result["line_or_service_no"] = line_or_service_no
    result["fraction_of_route"] = str(times_containing_infra_indexes[-1] - times_containing_infra_indexes[0] + 1) + "/" + str(route_length)
    if result["line_or_service_no"][:10] == "name = Svc":
        result["transport_mode"] = "bus"
        result["expressways"] = set(filter(lambda x: x in expressways, all_tags_within_range))
    else:
        result["transport_mode"] = "rail"
        result["starting_platform"] = set(filter(lambda x: x in mrt_lrt_stations, first_point_tags))
        result["middle_platforms"] = set(filter(lambda x: x in mrt_lrt_stations, middle_points_tags))
        result["ending_platform"] = set(filter(lambda x: x in mrt_lrt_stations, last_point_tags))
    return result


def get_route_type_by_time(query_kdtree_output):
    sorted_description_counts = query_kdtree_output[0]
    
    # print("------")
    classified = classify_descriptions(sorted_description_counts)
    keyword_tags = list(flatten(classified[:4]))

    traffic_infrastructure_by_time = get_infrastructure_by_time(keyword_tags, query_kdtree_output[1], query_kdtree_output[2])
    for i in traffic_infrastructure_by_time:
        print(i)

    print("------")
    for i in range(len(classified)-1):
        print(classified[i])
        print("------")

    main_infrastructure_counts = classified[1] + classified[2]  #MRT/LRT lines and Bus services only
    main_infrastructure_counts = sorted(main_infrastructure_counts, key=lambda x: x[1], reverse=True)
    # main_infrastructure_counts_combined = []
    # for elt, items in groupby(main_infrastructure_counts, itemgetter(1)):
    #     modes = ""
    #     for i in items:
    #         modes += i[0]+"; "
    #     modes = modes[:-2]
    #     main_infrastructure_counts_combined.append((modes, elt))
    # main_infrastructure_counts = main_infrastructure_counts_combined
    # main_infrastructure_counts = sorted(main_infrastructure_counts, key=lambda x: x[1], reverse=True)

    # print(main_infrastructure_counts)
    
    traffic_infrastructure_by_time_range = [] #list of lists [[start_time, end_time, traffic infrastructure], ...]
    for infra in main_infrastructure_counts:
        times_containing_infra = []
        times_containing_infra_indexes= []
        for point in traffic_infrastructure_by_time:
            if point_in_time_ranges(traffic_infrastructure_by_time_range, point):
                continue
            elif infra[0] in point[1]:
                times_containing_infra.append(point[0][0])
                times_containing_infra_indexes.append(traffic_infrastructure_by_time.index(point))
        if len(times_containing_infra) >= 2:
            dic = save_transport_mode_info(times_containing_infra, infra[0], times_containing_infra_indexes, len(query_kdtree_output[1]), list(flatten(classified[0])), list(flatten(classified[3])), traffic_infrastructure_by_time)
            traffic_infrastructure_by_time_range.append(dic)
            #traffic_infrastructure_by_time_range.append([times_containing_infra[0], times_containing_infra[-1], infra[0], str(len(times_containing_infra))+"/"+str(len(query_kdtree_output[1]))])
        # elif len(times_containing_infra) == 2:
        #     dic = save_transport_mode_info(times_containing_infra, infra[0], times_containing_infra_indexes, len(query_kdtree_output[1]), classified[0], classified[3], traffic_infrastructure_by_time)
        #     traffic_infrastructure_by_time_range.append(dic)
    traffic_infrastructure_by_time_range = sorted(traffic_infrastructure_by_time_range, key=lambda x: x["start_time"])
    return traffic_infrastructure_by_time_range

def extract_routes_and_get_route_type_by_time(raw_gpeh, new_filename, min_route_length_for_different_clusters=4, min_route_length_for_same_cluster=6, eliminate_long_intervals=True, max_negative_dot_product = 0.7, max_speed=150, above_max_speed_max_num = 1):
    erwt_output = erwt.process(raw_gpeh, new_filename, min_route_length_for_different_clusters, min_route_length_for_same_cluster, eliminate_long_intervals, max_negative_dot_product, max_speed, above_max_speed_max_num)
    if erwt_output == None:
        return
    all_route_lsts = erwt_output[1]
    centroids = erwt_output[2]
    all_routes_route_types = []
    for route_lst in all_route_lsts:
        query_kdtree_output = process("lat_long_kdtree.pickle", "descriptions_list.pickle", route_lst, "query_ball_point", 0.0025) #stores a list of tuples
        print("------")
        print("Length of route: " + str(len(query_kdtree_output[1])))
        all_routes_route_types.append(get_route_type_by_time(query_kdtree_output))
    return all_routes_route_types

##################### Main Function Run ##########################
if __name__== "__main__":
    for i in range(14,19):
        raw_data = read_csv("gpeh_output_201603"+str(i)+"_" + "525016C1DA9D6B108555429A7C41E409B57CAF.csv")
        all_routes_route_types = extract_routes_and_get_route_type_by_time(raw_data, "525016C1DA9D6B108555429A7C41E409B57CAF"+"_"+str(i)+"032016_route_cluster_info.csv")
        if all_routes_route_types != None:
            for item in all_routes_route_types:
                print(item)

    ## ACF 14 (both are MRT)
    #route_lst = [['2016-03-14 07:06', '1.3233600223081028', '103.76461889594793', '0', 'core'], ['2016-03-14 07:08', '1.3180506592921482', '103.76874078065157', '0', 'non-core'], ['2016-03-14 07:14', '1.3133589248117155', '103.76519858837128', '-1', 'non-core'], ['2016-03-14 07:15', '1.313254047845004', '103.77396080642939', '-1', 'non-core'], ['2016-03-14 07:16', '1.3107311125736218', '103.77748650631735', '-1', 'non-core'], ['2016-03-14 07:17', '1.3093012459868503', '103.78272084519267', '-1', 'non-core'], ['2016-03-14 07:18', '1.3083076183772913', '103.78953393548727', '-1', 'non-core'], ['2016-03-14 07:19', '1.306826212158573', '103.79145031794906', '-1', 'non-core'], ['2016-03-14 07:20', '1.3051378657857153', '103.79872865974903', '-1', 'non-core'], ['2016-03-14 07:21', '1.3005383429708492', '103.80110658418674', '-1', 'non-core'], ['2016-03-14 07:22', '1.2962636053632015', '103.80532130599022', '-1', 'non-core'], ['2016-03-14 07:23', '1.2932369947481046', '103.8084176927805', '-1', 'non-core'], ['2016-03-14 07:24', '1.29078180774499', '103.81220812350512', '-1', 'non-core'], ['2016-03-14 07:25', '1.2881611487344113', '103.81658770143986', '-1', 'non-core'], ['2016-03-14 07:26', '1.288461144678111', '103.82171373814344', '-1', 'non-core'], ['2016-03-14 07:29', '1.2820405467287337', '103.83914541453123', '1', 'non-core'], ['2016-03-14 07:30', '1.2827013217161618', '103.83687280118465', '-1', 'non-core'], ['2016-03-14 07:31', '1.2786948784713894', '103.84327869862318', '1', 'core'], ['2016-03-14 07:32',   '1.27679713',  '103.8460229','1','core']]
    #route_lst = [['2016-03-14 22:10', '1.27809935293682', '103.84470043703914', '1', 'core'], ['2016-03-14 22:11', '1.2818470290874484', '103.83920665830374', '1', 'non-core'], ['2016-03-14 22:12', '1.2816976450768935', '103.83909042924643', '1', 'non-core'], ['2016-03-14 22:14', '1.286474273728717', '103.82684355867761', '-1', 'non-core'], ['2016-03-14 22:15', '1.291191277334112', '103.81562311202288', '-1', 'non-core'], ['2016-03-14 22:16', '1.2912423752373938', '103.8142504170537', '-1', 'non-core'], ['2016-03-14 22:17', '1.292835479710971', '103.80769218572162', '-1', 'non-core'], ['2016-03-14 22:18', '1.2964265282204546', '103.80554815584964', '-1', 'non-core'], ['2016-03-14 22:19', '1.2992145708732998', '103.8016960332575', '-1', 'non-core'], ['2016-03-14 22:20', '1.2996420985280135', '103.80017828196287', '-1', 'non-core'], ['2016-03-14 22:45', '1.3170021923725648', '103.76097612082958', '-1', 'non-core'], ['2016-03-14 22:46', '1.3200993195776642', '103.76444678753614', '0', 'core'], ['2016-03-14 22:47', '1.3157646800602991', '103.77281371504068', '-1', 'non-core'], ['2016-03-14 22:48', '1.3183764614400615', '103.76681294292212', '0', 'core']]

    ## ACF 15  (1- MRT, 2- MRT, 3- Probably Bus)
    #route_lst = [['2016-03-15 07:05', '1.3210464269019375', '103.76680503040552', '0', 'core'], ['2016-03-15 07:13', '1.3132534520161414', '103.76341900974512', '-1', 'non-core'], ['2016-03-15 07:14', '1.3126451961217303', '103.77055194228888', '-1', 'non-core'], ['2016-03-15 07:15', '1.3120024182255512', '103.77716101706028', '-1', 'non-core'], ['2016-03-15 07:16', '1.3129672011129445', '103.7796550244093', '-1', 'non-core'], ['2016-03-15 07:17', '1.3093607085156895', '103.78343734145164', '-1', 'non-core'], ['2016-03-15 07:18', '1.307392154796083', '103.78908174378532', '-1', 'non-core'], ['2016-03-15 07:19', '1.3066388413374193', '103.79250213503838', '-1', 'non-core'], ['2016-03-15 07:20', '1.3041280078067172', '103.79979606717825', '-1', 'non-core'], ['2016-03-15 07:21', '1.29884365408583', '103.8013998334927', '-1', 'non-core'], ['2016-03-15 07:22', '1.297315477247027', '103.80369499325752', '-1', 'non-core'], ['2016-03-15 07:23', '1.2930196954459976', '103.80908379065139', '-1', 'non-core'], ['2016-03-15 07:24', '1.2909984188725747', '103.81482688415991', '-1', 'non-core'], ['2016-03-15 07:25', '1.2900106000638423', '103.81776901334524', '-1', 'non-core'], ['2016-03-15 07:26', '1.287885334063695', '103.82392224988767', '-1', 'non-core'], ['2016-03-15 07:27', '1.2870043361261452', '103.82687310129404', '-1', 'non-core'], ['2016-03-15 07:28', '1.2853787900000975', '103.82914493232965', '-1', 'non-core'], ['2016-03-15 07:29', '1.2815618922251006', '103.83906248956919', '1', 'non-core'], ['2016-03-15 07:30', '1.2819064698461313', '103.83917022496462', '1', 'non-core'], ['2016-03-15 07:31', '1.2788436143107091', '103.84292732924223', '1', 'core']]
    #route_lst = [['2016-03-15 19:49', '1.2837285740797182', '103.85184165090322', '1', 'core'], ['2016-03-15 19:50', '1.2934169445685637', '103.85250952094793', '-1', 'non-core'], ['2016-03-15 19:51', '1.293327113457977', '103.85244112461805', '-1', 'non-core'], ['2016-03-15 19:53', '1.2992237816303605', '103.8455069437623', '2', 'core']]
    #route_lst = [['2016-03-15 21:42', '1.296566840562577', '103.8470371440053', '2', 'core'], ['2016-03-15 21:44', '1.2997837722029975', '103.83818004280329', '2', 'non-core'], ['2016-03-15 21:45', '1.3010241232219386', '103.83507814258337', '-1', 'non-core'], ['2016-03-15 21:46', '1.30087123864907', '103.83316174149513', '-1', 'non-core'], ['2016-03-15 21:47', '1.2985909422933377', '103.83106280118227', '-1', 'non-core'], ['2016-03-15 21:48', '1.299574387356416', '103.83249644190073', '-1', 'non-core'], ['2016-03-15 21:49', '1.3017276420221102', '103.82684580981731', '-1', 'non-core'], ['2016-03-15 21:50', '1.30352520008441', '103.83076780289412', '-1', 'non-core'], ['2016-03-15 21:51', '1.3022121648769809', '103.82653132081032', '-1', 'non-core'], ['2016-03-15 21:52', '1.3050728376083942', '103.82045276463032', '-1', 'non-core'], ['2016-03-15 21:53', '1.307332683101915', '103.82019449025393', '-1', 'non-core'], ['2016-03-15 21:55', '1.3072482158542884', '103.81512556225061', '-1', 'non-core'], ['2016-03-15 21:57', '1.3094999178167541', '103.80479407629797', '-1', 'non-core'], ['2016-03-15 21:58', '1.3096062371041954', '103.80306074226445', '-1', 'non-core'], ['2016-03-15 21:59', '1.313417917405425', '103.7988255545497', '-1', 'non-core'], ['2016-03-15 22:00', '1.3112575157079316', '103.79172138869762', '-1', 'non-core'], ['2016-03-15 22:01', '1.3132787749128665', '103.79292956242959', '-1', 'non-core'], ['2016-03-15 22:02', '1.3152871463202163', '103.7898464128375', '-1', 'non-core'], ['2016-03-15 22:03', '1.3180044316681938', '103.78464741713327', '-1', 'non-core'], ['2016-03-15 22:04', '1.3179313325686128', '103.7852380424738', '-1', 'non-core'], ['2016-03-15 22:07', '1.3180519997113955', '103.77687136083841', '-1', 'non-core'], ['2016-03-15 22:08', '1.3194349821371614', '103.77102367579937', '-1', 'non-core'], ['2016-03-15 22:09', '1.3190197971802853', '103.77071108669043', '-1', 'non-core'], ['2016-03-15 22:10', '1.3161253420255812', '103.76925576478243', '-1', 'non-core'], ['2016-03-15 22:11', '1.3163715932259568', '103.76648213714361', '-1', 'non-core'], ['2016-03-15 22:14', '1.3151948608638642', '103.76736212521791', '-1', 'non-core'], ['2016-03-15 22:23', '1.322678587161389', '103.7637984752655', '0', 'core'], ['2016-03-15 22:24', '1.3237552063911369', '103.7628353945911', '0', 'non-core'], ['2016-03-15 22:25', '1.3222220151824344', '103.76337320144687', '0', 'core']]

    ## ACF 16 (both are MRT)
    #route_lst = [['2016-03-16 07:01', '1.3201989853572274', '103.76438174396753', '0', 'core'], ['2016-03-16 07:03', '1.3217256509927473', '103.76566509157419', '0', 'non-core'], ['2016-03-16 07:04', '1.3200557808870386', '103.76593763274806', '0', 'non-core'], ['2016-03-16 07:05', '1.316786328099121', '103.76702774316072', '-1', 'non-core'], ['2016-03-16 07:06', '1.317552794071684', '103.76757469028234', '-1', 'non-core'], ['2016-03-16 07:12', '1.3115536460669612', '103.7663596495986', '-1', 'non-core'], ['2016-03-16 07:13', '1.3127023238808981', '103.77016298253747', '-1', 'non-core'], ['2016-03-16 07:14', '1.3101265478435258', '103.77753212302923', '-1', 'non-core'], ['2016-03-16 07:15', '1.3088000278442269', '103.7828860245645', '-1', 'non-core'], ['2016-03-16 07:16', '1.3080416911742994', '103.78844525199383', '-1', 'non-core'], ['2016-03-16 07:17', '1.3063821579630204', '103.78932218214399', '-1', 'non-core'], ['2016-03-16 07:18', '1.3051795968205648', '103.79852134734392', '-1', 'non-core'], ['2016-03-16 07:19', '1.301529061408449', '103.80059082634173', '-1', 'non-core'], ['2016-03-16 07:20', '1.2960446628279723', '103.80419722231834', '-1', 'non-core'], ['2016-03-16 07:21', '1.2936323245078283', '103.80742257982493', '-1', 'non-core'], ['2016-03-16 07:22', '1.2918148111308565', '103.81082606008825', '-1', 'non-core'], ['2016-03-16 07:23', '1.2905083809928672', '103.81523173302412', '-1', 'non-core'], ['2016-03-16 07:24', '1.288817620864892', '103.81795973517', '-1', 'non-core'], ['2016-03-16 07:25', '1.2864257507464718', '103.82573828101158', '-1', 'non-core'], ['2016-03-16 07:26', '1.286577033898602', '103.82695186883211', '-1', 'non-core'], ['2016-03-16 07:27', '1.286170111270603', '103.82683206349611', '-1', 'non-core'], ['2016-03-16 07:29', '1.280815351015694', '103.84064865857363', '1', 'core']]
    #route_lst = [['2016-03-16 21:18', '1.2820026699918707', '103.83881097659469', '1', 'core'], ['2016-03-16 21:20', '1.2864471136359281', '103.82684728503227', '-1', 'non-core'], ['2016-03-16 21:21', '1.2890882881595167', '103.82024891674519', '-1', 'non-core'], ['2016-03-16 21:22', '1.2911493782626309', '103.81206465885043', '-1', 'non-core'], ['2016-03-16 21:23', '1.2933287886356712', '103.8061292655766', '-1', 'non-core'], ['2016-03-16 21:24', '1.2968595046435136', '103.80591862190228', '-1', 'non-core'], ['2016-03-16 21:25', '1.3004927259883377', '103.8015195960179', '-1', 'non-core'], ['2016-03-16 21:26', '1.3046082659085454', '103.79918329417706', '-1', 'non-core'], ['2016-03-16 21:27', '1.3062800397665855', '103.79760157316923', '-1', 'non-core'], ['2016-03-16 21:28', '1.3066864391832307', '103.79264462739229', '-1', 'non-core'], ['2016-03-16 21:29', '1.3083769640486023', '103.78850958310068', '-1', 'non-core'], ['2016-03-16 21:30', '1.3098033110390908', '103.78163142928055', '-1', 'non-core'], ['2016-03-16 21:31', '1.3111528278101374', '103.7770452350378', '-1', 'non-core'], ['2016-03-16 21:32', '1.3123823706828188', '103.77182960672224', '-1', 'non-core'], ['2016-03-16 21:33', '1.3124552548554158', '103.76357015222311', '-1', 'non-core'], ['2016-03-16 21:39', '1.3189179751276163', '103.76589637249708', '0', 'non-core'], ['2016-03-16 21:40', '1.316401983556112', '103.76584265381098', '-1', 'non-core'], ['2016-03-16 21:41', '1.3140384605159547', '103.76652114093304', '-1', 'non-core'], ['2016-03-16 21:42', '1.3254051032471796', '103.76900363713503', '-1', 'non-core'], ['2016-03-16 21:43', '1.3186146676254469', '103.7657007202506', '0', 'non-core'], ['2016-03-16 21:45', '1.3138996948653279', '103.76844238489866', '-1', 'non-core'], ['2016-03-16 21:46', '1.3243664759151264', '103.76747991889715', '0', 'non-core'], ['2016-03-16 21:47', '1.3198108382315668', '103.76696180552244', '0', 'non-core'], ['2016-03-16 21:48', '1.3190977810482902', '103.76493774354458', '0', 'non-core'], ['2016-03-16 21:50', '1.3245163376168803', '103.76467060297728', '0', 'non-core'], ['2016-03-16 21:51', '1.3249540322845716', '103.76581898331642', '0', 'non-core'], ['2016-03-16 21:52', '1.323749603968767', '103.76098009624651', '0', 'non-core'], ['2016-03-16 21:53', '1.3239938948051977', '103.76197334378958', '0', 'non-core']]

    ## ACF 17 (both are MRT)
    #route_lst = [['2016-03-17 06:13', '1.319542745514412', '103.76699600368738', '0', 'non-core'], ['2016-03-17 06:15', '1.3168278952797627', '103.7666255235672', '0', 'core'], ['2016-03-17 06:16', '1.3167905776535251', '103.76597408205271', '0', 'non-core'], ['2016-03-17 06:17', '1.3164655095184885', '103.76586200403315', '0', 'non-core'], ['2016-03-17 06:18', '1.3157787579436784', '103.76457832753658', '0', 'core'], ['2016-03-17 06:19', '1.309180243728243', '103.76576419919729', '-1', 'non-core'], ['2016-03-17 06:21', '1.312897794637066', '103.76774666458368', '0', 'non-core'], ['2016-03-17 06:22', '1.311868035468034', '103.77597436308861', '-1', 'non-core'], ['2016-03-17 06:23', '1.3108009917807815', '103.77932488918304', '-1', 'non-core'], ['2016-03-17 06:24', '1.308144263450578', '103.78592742312895', '-1', 'non-core'], ['2016-03-17 06:25', '1.306856715040597', '103.7886203750968', '-1', 'non-core'], ['2016-03-17 06:26', '1.3047194371225992', '103.79533555358648', '-1', 'non-core'], ['2016-03-17 06:27', '1.3015887458150988', '103.79944637417793', '-1', 'non-core'], ['2016-03-17 06:28', '1.2973814505906405', '103.80351962288842', '-1', 'non-core'], ['2016-03-17 06:29', '1.2943208414845426', '103.8068100437522', '-1', 'non-core'], ['2016-03-17 06:30', '1.2919204293561646', '103.81014760583639', '-1', 'non-core'], ['2016-03-17 06:31', '1.291309264561751', '103.81260026246309', '-1', 'non-core'], ['2016-03-17 06:32', '1.2888534307055963', '103.81859343498945', '-1', 'non-core'], ['2016-03-17 06:33', '1.2878964814445388', '103.8238318786025', '-1', 'non-core'], ['2016-03-17 06:34', '1.2864844252493055', '103.82684825254339', '-1', 'non-core'], ['2016-03-17 06:35', '1.2854961518800718', '103.82896073162556', '-1', 'non-core'], ['2016-03-17 06:36', '1.2817060248823822', '103.8389970548451', '1', 'core']]
    #route_lst = [['2016-03-17 23:15', '1.2817227844998857', '103.83898682892323', '1', 'core'], ['2016-03-17 23:16', '1.2845686979823996', '103.83197989314795', '-1', 'non-core'], ['2016-03-17 23:17', '1.2864746328713197', '103.82658194750547', '-1', 'non-core'], ['2016-03-17 23:18', '1.2866269773124928', '103.82590921595693', '-1', 'non-core'], ['2016-03-17 23:21', '1.294109782991833', '103.80425062961876', '-1', 'non-core'], ['2016-03-17 23:22', '1.2968237114771737', '103.80406159504845', '-1', 'non-core'], ['2016-03-17 23:23', '1.3015453056614783', '103.8007577508688', '-1', 'non-core'], ['2016-03-17 23:24', '1.304669806845967', '103.7979285120964', '-1', 'non-core'], ['2016-03-17 23:25', '1.306629679927851', '103.7934410199523', '-1', 'non-core'], ['2016-03-17 23:26', '1.306957857803345', '103.78861607518047', '-1', 'non-core'], ['2016-03-17 23:27', '1.3087218395369566', '103.78433018177748', '-1', 'non-core'], ['2016-03-17 23:28', '1.3102022076994', '103.77967181400611', '-1', 'non-core'], ['2016-03-17 23:29', '1.3122449375507212', '103.7765185162425', '-1', 'non-core'], ['2016-03-17 23:30', '1.3133687557029774', '103.7675759056583', '0', 'non-core'], ['2016-03-17 23:31', '1.3118731445531915', '103.76828849315643', '-1', 'non-core'], ['2016-03-17 23:32', '1.31291222607393', '103.77029746770859', '-1', 'non-core'], ['2016-03-17 23:33', '1.3170563589545206', '103.76383998245001', '0', 'core'], ['2016-03-17 23:34', '1.3175130154723247', '103.76218724995852', '0', 'non-core'], ['2016-03-17 23:36', '1.3154368638605662', '103.76598492264748', '0', 'core'], ['2016-03-17 23:37', '1.3153316173773477', '103.76009250059724', '0', 'non-core'], ['2016-03-17 23:38', '1.3170786123756035', '103.75910779461265', '0', 'non-core'], ['2016-03-17 23:39', '1.320792959299683', '103.76319414004683', '-1', 'non-core'], ['2016-03-17 23:40', '1.3227192772396947', '103.76400547474623', '-1', 'non-core'], ['2016-03-17 23:41', '1.3162207978119842', '103.76402277499437', '0', 'non-core'], ['2016-03-17 23:42', '1.3204655684910023', '103.76491528004408', '-1', 'non-core'], ['2016-03-17 23:43', '1.3228080812832552', '103.76059617847204', '-1', 'non-core'], ['2016-03-17 23:44', '1.3302460835663827', '103.76536957919598', '-1', 'non-core'], ['2016-03-17 23:45', '1.3147148718868757', '103.7689184769988', '0', 'non-core']]

    ## ACF 18 (both are MRT)
    #route_lst = [['2016-03-18 06:59', '1.3219900468291848', '103.76478894799948', '0', 'core'], ['2016-03-18 07:14', '1.313207329662685', '103.76380471140146', '-1', 'non-core'], ['2016-03-18 07:15', '1.311832460344731', '103.77326876211625', '-1', 'non-core'], ['2016-03-18 07:16', '1.310101043822331', '103.7787238880992', '-1', 'non-core'], ['2016-03-18 07:17', '1.3087495259982636', '103.7849185243249', '-1', 'non-core'], ['2016-03-18 07:18', '1.3076158802598385', '103.78937851637602', '-1', 'non-core'], ['2016-03-18 07:19', '1.3036704066362317', '103.78954600542784', '-1', 'non-core'], ['2016-03-18 07:20', '1.3046218979236615', '103.79916742444038', '-1', 'non-core'], ['2016-03-18 07:21', '1.2995937268839954', '103.80113188463908', '-1', 'non-core'], ['2016-03-18 07:22', '1.2958862927501722', '103.80559785291553', '-1', 'non-core'], ['2016-03-18 07:23', '1.2936113548162904', '103.80770199000835', '-1', 'non-core'], ['2016-03-18 07:24', '1.2919213231751907', '103.81111358106136', '-1', 'non-core'], ['2016-03-18 07:25', '1.2899396735603084', '103.81492283195257', '-1', 'non-core'], ['2016-03-18 07:26', '1.289197783846416', '103.81885528564453', '-1', 'non-core'], ['2016-03-18 07:27', '1.287241159940274', '103.82607970386744', '-1', 'non-core'], ['2016-03-18 07:28', '1.28645301301019', '103.82687196135521', '-1', 'non-core'], ['2016-03-18 07:29', '1.2863940192816035', '103.82688537240028', '-1', 'non-core'], ['2016-03-18 07:30', '1.2840000785968293', '103.83299879729748', '-1', 'non-core'], ['2016-03-18 07:31', '1.2819654636681563', '103.83935797959566', '1', 'core']]
    #route_lst = [['2016-03-18 18:43', '1.2817408848788987', '103.83913904428482', '1', 'core'], ['2016-03-18 18:44', '1.2871770268070801', '103.82683273404837', '-1', 'non-core'], ['2016-03-18 18:46', '1.2882281869924235', '103.82326439023018', '-1', 'non-core'], ['2016-03-18 18:54', '1.308243056208372', '103.78991078585386', '-1', 'non-core'], ['2016-03-18 18:55', '1.308567786164158', '103.78228030353785', '-1', 'non-core'], ['2016-03-18 18:56', '1.3087743877653588', '103.77870404720306', '-1', 'non-core'], ['2016-03-18 18:57', '1.3130241837219223', '103.76970771700144', '-1', 'non-core'], ['2016-03-18 18:58', '1.3119073367493599', '103.7643526867032', '-1', 'non-core'], ['2016-03-18 19:00', '1.3145794549094465', '103.76123059540987', '-1', 'non-core'], ['2016-03-18 19:01', '1.318000380427045', '103.76620944589376', '0', 'core'], ['2016-03-18 19:03', '1.3164854673847457', '103.76565100997686', '0', 'non-core'], ['2016-03-18 19:04', '1.3191402412616189', '103.76451920717955', '0', 'core'], ['2016-03-18 19:05', '1.3189208056743453', '103.76630131155252', '0', 'non-core'], ['2016-03-18 19:06', '1.3126282108622902', '103.7681109085679', '-1', 'non-core'], ['2016-03-18 19:07', '1.3270595829234082', '103.76484666019678', '-1', 'non-core'], ['2016-03-18 19:08', '1.3196938805567147', '103.76931209117174', '0', 'non-core'], ['2016-03-18 19:09', '1.3157687023129894', '103.76898888498545', '0', 'non-core'], ['2016-03-18 19:11', '1.3203708254723079', '103.7642802670598', '0', 'core'], ['2016-03-18 19:12', '1.318398359399299', '103.76562852412462', '0', 'non-core'], ['2016-03-18 19:13', '1.3188584594180754', '103.76698426902294', '0', 'non-core'], ['2016-03-18 19:14', '1.3228129975520773', '103.76603577286005', '0', 'core'], ['2016-03-18 19:15', '1.3114635474777612', '103.76680623739958', '-1', 'non-core'], ['2016-03-18 19:16', '1.3306965779443647', '103.7766720727086', '-1', 'non-core'], ['2016-03-18 19:17', '1.3220737092394406', '103.76181223243475', '0', 'core']]
    
    ## CAF 14 (both likely to be driving)
    #route_lst = [['2016-03-14 12:01', '1.3898775863695354', '103.85576706379652', '0', 'core'], ['2016-03-14 12:03', '1.3633832185081631', '103.85932317003608', '-1', 'non-core'], ['2016-03-14 12:04', '1.347962766140173', '103.85969616472721', '-1', 'non-core'], ['2016-03-14 12:05', '1.3398783498677918', '103.86001098901033', '-1', 'non-core'], ['2016-03-14 12:06', '1.3443944588189953', '103.86783499270678', '-1', 'non-core'], ['2016-03-14 12:07', '1.3202721904806627', '103.85644347220659', '-1', 'non-core'], ['2016-03-14 12:08', '1.314231306994999', '103.84620152413845', '-1', 'non-core'], ['2016-03-14 12:09', '1.3047074829731766', '103.84308222681284', '-1', 'non-core'], ['2016-03-14 12:11', '1.2779786841891019', '103.8392647728324', '-1', 'non-core'], ['2016-03-14 12:12', '1.2803039153430866', '103.83615408092737', '-1', 'non-core'], ['2016-03-14 12:13', '1.277625052946498', '103.82928913459182', '-1', 'non-core'], ['2016-03-14 12:14', '1.2808673737679876', '103.82347863167524', '-1', 'non-core'], ['2016-03-14 12:16', '1.2718185050904263', '103.82114510983229', '1', 'non-core'], ['2016-03-14 12:17', '1.2693715911810888', '103.82284495979548', '1', 'non-core'], ['2016-03-14 12:18', '1.2660826646397687', '103.82673047482967', '-1', 'non-core'], ['2016-03-14 12:19', '1.2694687972152665', '103.82518719881773', '-1', 'non-core'], ['2016-03-14 12:21', '1.2659342791961858', '103.82406245917082', '1', 'non-core'], ['2016-03-14 12:22', '1.2562728529154779', '103.82206879556179', '1', 'core']]
    ###route_lst = [['2016-03-14 12:01:01', '1.3890275762664057', '103.85666694492102'], ['2016-03-14 12:01:12', '1.3890275762664057', '103.85666694492102'], ['2016-03-14 12:01:12', '1.3907275964726649', '103.85486718267202'], ['2016-03-14 12:01:16', '1.3907275964726649', '103.85486718267202'], ['2016-03-14 12:03:17', '1.367787946752678', '103.85920096188784'], ['2016-03-14 12:03:18', '1.3665196230428185', '103.8586363568902'], ['2016-03-14 12:03:18', '1.367787946752678', '103.85920096188784'], ['2016-03-14 12:03:23', '1.3621823799289676', '103.8587087765336'], ['2016-03-14 12:03:23', '1.3665196230428185', '103.8586363568902'], ['2016-03-14 12:03:23', '1.3669727874050908', '103.85962944477797'], ['2016-03-14 12:03:33', '1.3650086276432796', '103.86028792709112'], ['2016-03-14 12:03:33', '1.3621823799289676', '103.8587087765336'], ['2016-03-14 12:03:46', '1.3650086276432796', '103.86028792709112'], ['2016-03-14 12:03:53', '1.3594727721527284', '103.8585364446044'], ['2016-03-14 12:03:54', '1.3516831356519226', '103.86150766164064'], ['2016-03-14 12:03:54', '1.3594727721527284', '103.8585364446044'], ['2016-03-14 12:04:04', '1.3516831356519226', '103.86150766164064'], ['2016-03-14 12:04:15', '1.354231864569166', '103.85561283677816'], ['2016-03-14 12:04:23', '1.3469650975283396', '103.85969381779432'], ['2016-03-14 12:04:23', '1.354231864569166', '103.85561283677816'], ['2016-03-14 12:04:33', '1.3469650975283396', '103.85969381779432'], ['2016-03-14 12:04:44', '1.347332458597223', '103.85515753179789'], ['2016-03-14 12:04:44', '1.3411463053386132', '103.86514540761709'], ['2016-03-14 12:04:54', '1.3411463053386132', '103.86514540761709'], ['2016-03-14 12:05:23', '1.3413098752622405', '103.86012967675924'], ['2016-03-14 12:05:28', '1.3419507474806474', '103.85902795940638'], ['2016-03-14 12:05:28', '1.3413098752622405', '103.86012967675924'], ['2016-03-14 12:05:41', '1.337040964825798', '103.86043343693018'], ['2016-03-14 12:05:41', '1.3419507474806474', '103.85902795940638'], ['2016-03-14 12:05:42', '1.337040964825798', '103.86043343693018'], ['2016-03-14 12:05:42', '1.3385452739371702', '103.86089477688074'], ['2016-03-14 12:06:00', '1.3473190512599076', '103.8713051006198'], ['2016-03-14 12:06:00', '1.3385452739371702', '103.86089477688074'], ['2016-03-14 12:06:03', '1.3473190512599076', '103.8713051006198'], ['2016-03-14 12:07:21', '1.3221010607404589', '103.85775994509459'], ['2016-03-14 12:07:24', '1.3183563501975888', '103.85612782090902'], ['2016-03-14 12:07:24', '1.3221010607404589', '103.85775994509459'], ['2016-03-14 12:07:30', '1.3183563501975888', '103.85612782090902'], ['2016-03-14 12:07:30', '1.317138949351338', '103.85568927973509'], ['2016-03-14 12:07:31', '1.320819305815499', '103.85715376585722'], ['2016-03-14 12:07:31', '1.317138949351338', '103.85568927973509'], ['2016-03-14 12:07:33', '1.320819305815499', '103.85715376585722'], ['2016-03-14 12:07:33', '1.3210163957894625', '103.85754939168692'], ['2016-03-14 12:07:35', '1.3194490608026421', '103.85724429041147'], ['2016-03-14 12:07:35', '1.3210163957894625', '103.85754939168692'], ['2016-03-14 12:07:36', '1.322425521610258', '103.85764997452497'], ['2016-03-14 12:07:36', '1.3194490608026421', '103.85724429041147'], ['2016-03-14 12:07:39', '1.322425521610258', '103.85764997452497'], ['2016-03-14 12:07:54', '1.3214695685954458', '103.84830314666033'], ['2016-03-14 12:08:06', '1.3172207351096514', '103.84834874421358'], ['2016-03-14 12:08:11', '1.315284691192887', '103.84711157530546'], ['2016-03-14 12:08:11', '1.3172207351096514', '103.84834874421358'], ['2016-03-14 12:08:14', '1.3132038445328635', '103.84725105017424'], ['2016-03-14 12:08:14', '1.315284691192887', '103.84711157530546'], ['2016-03-14 12:08:19', '1.3132038445328635', '103.84725105017424'], ['2016-03-14 12:08:19', '1.3135591438597796', '103.84454671293497'], ['2016-03-14 12:08:34', '1.3135591438597796', '103.84454671293497'], ['2016-03-14 12:08:36', '1.313391549843944', '103.84483303874731'], ['2016-03-14 12:08:48', '1.313391549843944', '103.84483303874731'], ['2016-03-14 12:08:48', '1.3127278774308682', '103.84511802345514'], ['2016-03-14 12:08:49', '1.3127278774308682', '103.84511802345514'], ['2016-03-14 12:09:35', '1.3047074829731766', '103.84308222681284'], ['2016-03-14 12:09:40', '1.3047074829731766', '103.84308222681284'], ['2016-03-14 12:11:32', '1.2791538698957698', '103.83556198328733'], ['2016-03-14 12:11:32', '1.2768034984824337', '103.84296756237745'], ['2016-03-14 12:12:24', '1.2797625795401757', '103.84029272943735'], ['2016-03-14 12:12:25', '1.2805549744775784', '103.83223939687014'], ['2016-03-14 12:12:26', '1.2805549744775784', '103.83223939687014'], ['2016-03-14 12:12:47', '1.2803431328770143', '103.83984480053186'], ['2016-03-14 12:13:06', '1.278334659111155', '103.83041750639677'], ['2016-03-14 12:13:12', '1.2708598514386835', '103.82572297006845'], ['2016-03-14 12:13:12', '1.278334659111155', '103.83041750639677'], ['2016-03-14 12:13:19', '1.2708598514386835', '103.82572297006845'], ['2016-03-14 12:13:35', '1.280222463603054', '103.82589597254992'], ['2016-03-14 12:13:40', '1.281083237633099', '103.83512008935213'], ['2016-03-14 12:13:40', '1.280222463603054', '103.82589597254992'], ['2016-03-14 12:13:49', '1.281083237633099', '103.83512008935213'], ['2016-03-14 12:14:29', '1.2808673737679876', '103.82347863167524'], ['2016-03-14 12:14:43', '1.2808673737679876', '103.82347863167524'], ['2016-03-14 12:16:15', '1.2719619679416827', '103.82365297526121'], ['2016-03-14 12:16:18', '1.2721604024931787', '103.82265452295542'], ['2016-03-14 12:16:18', '1.2719619679416827', '103.82365297526121'], ['2016-03-14 12:16:26', '1.2713331448364182', '103.81712783128023'], ['2016-03-14 12:16:26', '1.2721604024931787', '103.82265452295542'], ['2016-03-14 12:16:29', '1.2713331448364182', '103.81712783128023'], ['2016-03-14 12:17:18', '1.2693715911810888', '103.82284495979548'], ['2016-03-14 12:17:28', '1.2693715911810888', '103.82284495979548'], ['2016-03-14 12:18:14', '1.262545694662681', '103.82865060120821'], ['2016-03-14 12:18:24', '1.262545694662681', '103.82865060120821'], ['2016-03-14 12:18:35', '1.2696196346168565', '103.82481034845114'], ['2016-03-14 12:18:46', '1.2696196346168565', '103.82481034845114'], ['2016-03-14 12:19:37', '1.2685041093564244', '103.8246326521039'], ['2016-03-14 12:19:46', '1.2704334850741088', '103.82574174553156'], ['2016-03-14 12:19:46', '1.2685041093564244', '103.8246326521039'], ['2016-03-14 12:19:51', '1.2704334850741088', '103.82574174553156'], ['2016-03-14 12:21:23', '1.2706372828420558', '103.82532265037298'], ['2016-03-14 12:21:24', '1.2706372828420558', '103.82532265037298'], ['2016-03-14 12:21:47', '1.2565282719044462', '103.82154207676649'], ['2016-03-14 12:22:18', '1.2561729646453157', '103.82202822715044'], ['2016-03-14 12:22:29', '1.2561729646453157', '103.82202822715044'], ['2016-03-14 12:22:42', '1.2563727411856398', '103.82210936397314'], ['2016-03-14 12:22:53', '1.2563727411856398', '103.82210936397314']]
    #route_lst = [['2016-03-14 18:31', '1.2561072663166335', '103.82180627435446', '1', 'core'], ['2016-03-14 18:32', '1.266428586607624', '103.82641263306141', '-1', 'non-core'], ['2016-03-14 18:33', '1.2686352791558666', '103.82281366735697', '1', 'non-core'], ['2016-03-14 18:34', '1.2704120308121174', '103.81669515743852', '-1', 'non-core'], ['2016-03-14 18:35', '1.2684705899601498', '103.82110890001059', '1', 'non-core'], ['2016-03-14 18:37', '1.2692533312648973', '103.81251469999552', '-1', 'non-core'], ['2016-03-14 18:38', '1.2725449810264913', '103.8114270195365', '-1', 'non-core'], ['2016-03-14 18:39', '1.2739333517421303', '103.81502855569124', '-1', 'non-core'], ['2016-03-14 18:40', '1.2767310966245902', '103.81693203002214', '-1', 'non-core'], ['2016-03-14 18:41', '1.2809983219772054', '103.82000807672739', '-1', 'non-core'], ['2016-03-14 18:42', '1.2847609638177038', '103.82242687046528', '-1', 'non-core'], ['2016-03-14 18:44', '1.284979955395704', '103.81736990064383', '-1', 'non-core'], ['2016-03-14 18:45', '1.2816047961759696', '103.82144659012556', '-1', 'non-core'], ['2016-03-14 18:46', '1.2821729839473235', '103.82471051067114', '-1', 'non-core'], ['2016-03-14 18:47', '1.2805557789123179', '103.82933684438467', '-1', 'non-core'], ['2016-03-14 18:48', '1.2832833541286381', '103.8333603926003', '-1', 'non-core'], ['2016-03-14 18:49', '1.2858148080903051', '103.82839646190405', '-1', 'non-core'], ['2016-03-14 18:51', '1.3040300638759816', '103.84239440783858', '-1', 'non-core'], ['2016-03-14 18:52', '1.3089549969743233', '103.84352412074804', '-1', 'non-core'], ['2016-03-14 18:53', '1.3149958077079833', '103.846478522397', '-1', 'non-core'], ['2016-03-14 18:54', '1.3222010397073762', '103.85382840143782', '-1', 'non-core'], ['2016-03-14 18:55', '1.3302192699954325', '103.8603750988841', '-1', 'non-core'], ['2016-03-14 18:56', '1.3359214471012293', '103.86194955557585', '-1', 'non-core'], ['2016-03-14 19:00', '1.3517667053561102', '103.85496865957975', '-1', 'non-core'], ['2016-03-14 19:01', '1.3561058295130701', '103.85839328169823', '-1', 'non-core'], ['2016-03-14 19:02', '1.3627365447002686', '103.86030603200197', '-1', 'non-core'], ['2016-03-14 19:03', '1.3753742263192381', '103.86062631214207', '-1', 'non-core'], ['2016-03-14 19:04', '1.387007459355204', '103.85884741321206', '0', 'non-core'], ['2016-03-14 19:05', '1.3914277810968678', '103.85729525238276', '0', 'core']]
    
    ## CAF 15 (all likely to be driving. else, bus.)
    #route_lst = [['2016-03-15 08:20', '1.3885100616861046', '103.85647986084223', '0', 'core'], ['2016-03-15 08:21', '1.3732902650976146', '103.85411348193884', '-1', 'non-core'], ['2016-03-15 08:22', '1.3761644970137272', '103.85619561374187', '-1', 'non-core'], ['2016-03-15 08:23', '1.3769590065173736', '103.85733995586634', '-1', 'non-core'], ['2016-03-15 08:24', '1.3760525282970693', '103.86198863919292', '-1', 'non-core'], ['2016-03-15 08:25', '1.3707496006687951', '103.86673796921968', '-1', 'non-core'], ['2016-03-15 08:28', '1.3547668157482022', '103.85999757796526', '-1', 'non-core'], ['2016-03-15 08:32', '1.356689419037774', '103.84746361523867', '1', 'core'], ['2016-03-15 08:33', '1.3497058242374724', '103.84930374473333', '1', 'core'], ['2016-03-15 08:37', '1.3408821801109767', '103.83140925318003', '-1', 'non-core'], ['2016-03-15 08:38', '1.3501104571254665', '103.83715476840734', '-1', 'non-core'], ['2016-03-15 08:39', '1.3488287169767954', '103.83603002876043', '-1', 'non-core'], ['2016-03-15 08:45', '1.3134746764772043', '103.79781994968653', '-1', 'non-core'], ['2016-03-15 08:46', '1.3103755256819885', '103.80575012415648', '-1', 'non-core'], ['2016-03-15 08:47', '1.3031642714056364', '103.80029026418924', '-1', 'non-core'], ['2016-03-15 08:48', '1.3003674493782644', '103.80341369658709', '2', 'non-core'], ['2016-03-15 08:49', '1.2995603123006092', '103.79845764487982', '-1', 'non-core'], ['2016-03-15 08:50', '1.289141916511019', '103.80317263305187', '2', 'core']]
    #route_lst = [['2016-03-15 18:18', '1.2820787586111713', '103.82085392251611', '2', 'core'], ['2016-03-15 18:19', '1.28217596437303', '103.82388699799776', '2', 'non-core'], ['2016-03-15 18:21', '1.2842988441021335', '103.82737163454294', '-1', 'non-core'], ['2016-03-15 18:22', '1.2842253275563793', '103.83186941966414', '-1', 'non-core'], ['2016-03-15 18:23', '1.2878478859609175', '103.839188617255', '-1', 'non-core'], ['2016-03-15 18:25', '1.2973221290909158', '103.84538624435663', '-1', 'non-core'], ['2016-03-15 18:26', '1.307758373124499', '103.84019650518894', '-1', 'non-core'], ['2016-03-15 18:27', '1.3085675188800574', '103.84196173399687', '-1', 'non-core'], ['2016-03-15 18:28', '1.3226239522039356', '103.85087203234434', '-1', 'non-core'], ['2016-03-15 18:30', '1.3317436978693469', '103.8609242811799', '-1', 'non-core'], ['2016-03-15 18:31', '1.345451071634758', '103.86367103084922', '-1', 'non-core'], ['2016-03-15 18:33', '1.369524179128997', '103.86357245966792', '-1', 'non-core'], ['2016-03-15 18:35', '1.391158495800758', '103.85661980509758', '0', 'core']]
    #route_lst = [['2016-03-15 19:41', '1.3901175723892683', '103.85411079972982', '0', 'core'], ['2016-03-15 19:43', '1.3618471985284089', '103.85855253785849', '-1', 'non-core'], ['2016-03-15 19:44', '1.3532021820881026', '103.85826978832483', '-1', 'non-core'], ['2016-03-15 19:45', '1.36088388672662', '103.8513751141727', '1', 'non-core'], ['2016-03-15 19:46', '1.357035862197964', '103.85047546774149', '1', 'core']]
    #route_lst = [['2016-03-15 20:51', '1.3537769739647028', '103.84952565921205', '1', 'core'], ['2016-03-15 20:52', '1.3639280022462879', '103.85517496615648', '-1', 'non-core'], ['2016-03-15 20:53', '1.35606946779168', '103.85908106714487', '-1', 'non-core'], ['2016-03-15 20:54', '1.363583437275404', '103.8597809895873', '-1', 'non-core'], ['2016-03-15 20:56', '1.3833075545201297', '103.86082141846418', '-1', 'non-core'], ['2016-03-15 20:57', '1.390082039868195', '103.85755995288491', '0', 'core']]
    
    ## CAF 16 (all likely to be driving)
    #route_lst = [['2016-03-16 08:01', '1.390421912338765', '103.85662715882063', '0', 'core'], ['2016-03-16 08:02', '1.37732259041246', '103.86175734374453', '-1', 'non-core'], ['2016-03-16 08:03', '1.3654802762047928', '103.85989244243032', '1', 'non-core'], ['2016-03-16 08:04', '1.355396958589544', '103.8614895567298', '1', 'core']]
    #route_lst = [['2016-03-16 08:10', '1.3512098574468072', '103.8505045697093', '1', 'core'], ['2016-03-16 08:13', '1.347741382349609', '103.84251158684492', '1', 'non-core'], ['2016-03-16 08:15', '1.347616694130748', '103.836221806705', '-1', 'non-core'], ['2016-03-16 08:16', '1.347238607227437', '103.83937496691942', '-1', 'non-core'], ['2016-03-16 08:17', '1.344331891563539', '103.8370719179511', '-1', 'non-core'], ['2016-03-16 08:18', '1.33973822085078', '103.82892516656564', '-1', 'non-core'], ['2016-03-16 08:19', '1.3379964643426587', '103.82102463394403', '-1', 'non-core'], ['2016-03-16 08:20', '1.3336200653083465', '103.813347928226', '-1', 'non-core'], ['2016-03-16 08:22', '1.3113877835842516', '103.80961261689663', '-1', 'non-core'], ['2016-03-16 08:23', '1.3146913474274071', '103.8042611527172', '-1', 'non-core'], ['2016-03-16 08:24', '1.3000094667109483', '103.80521547049284', '-1', 'non-core'], ['2016-03-16 08:25', '1.2973290191443199', '103.79928309470415', '-1', 'non-core'], ['2016-03-16 08:26', '1.2908730676801197', '103.80107715725899', '-1', 'non-core'], ['2016-03-16 08:27', '1.2888167832139148', '103.80399014800787', '2', 'non-core'], ['2016-03-16 08:28', '1.2819328376535712', '103.8096596673131', '2', 'core']]
    #route_lst = [['2016-03-16 18:05', '1.2828155109703334', '103.82104358822107', '2', 'core'], ['2016-03-16 18:06', '1.2850090071095004', '103.82326941937208', '2', 'non-core'], ['2016-03-16 18:07', '1.2849969378819324', '103.81800223141909', '2', 'core'], ['2016-03-16 18:08', '1.2898666021752963', '103.82302466779947', '2', 'non-core'], ['2016-03-16 18:10', '1.2809859467925968', '103.82970441598445', '-1', 'non-core'], ['2016-03-16 18:11', '1.2880878519015608', '103.84015951305628', '-1', 'non-core'], ['2016-03-16 18:12', '1.2923072396423914', '103.8436884060502', '-1', 'non-core'], ['2016-03-16 18:13', '1.2987003423061927', '103.8429391309619', '-1', 'non-core'], ['2016-03-16 18:19', '1.3471621854079463', '103.8618878647685', '1', 'non-core'], ['2016-03-16 18:20', '1.3577780918367832', '103.8624182716012', '1', 'non-core'], ['2016-03-16 18:22', '1.376930809094648', '103.85767637310843', '0', 'non-core'], ['2016-03-16 18:23', '1.3829195560188732', '103.86193507164717', '-1', 'non-core'], ['2016-03-16 18:24', '1.389336274561562', '103.85297790169716', '0', 'core']]

    ## CAF 17 (1- likely to be driving 2- driving or bus)
    #route_lst = [['2016-03-17 08:09', '1.38857479845739', '103.8593441726906', '0', 'core'], ['2016-03-17 08:10', '1.379094892266744', '103.86023998260498', '-1', 'non-core'], ['2016-03-17 08:11', '1.377579518335643', '103.85999817401171', '-1', 'non-core'], ['2016-03-17 08:13', '1.3644103949834852', '103.8604369238019', '-1', 'non-core'], ['2016-03-17 08:14', '1.3619915496848478', '103.85908786207438', '-1', 'non-core'], ['2016-03-17 08:15', '1.355948220906795', '103.85920654982328', '-1', 'non-core'], ['2016-03-17 08:17', '1.3584841396925358', '103.85744720983963', '-1', 'non-core'], ['2016-03-17 08:18', '1.3568006984563998', '103.851552978158', '-1', 'non-core'], ['2016-03-17 08:19', '1.3520414735244586', '103.84994313459505', '-1', 'non-core'], ['2016-03-17 08:20', '1.3503796462051543', '103.84835001081228', '-1', 'non-core'], ['2016-03-17 08:21', '1.3491535753286634', '103.84703151136637', '-1', 'non-core'], ['2016-03-17 08:22', '1.3459233465367644', '103.83963324129581', '-1', 'non-core'], ['2016-03-17 08:23', '1.3510217510459235', '103.83950711041689', '-1', 'non-core'], ['2016-03-17 08:24', '1.345870385342266', '103.83860545232892', '-1', 'non-core'], ['2016-03-17 08:25', '1.345679330772804', '103.83822910487652', '-1', 'non-core'], ['2016-03-17 08:26', '1.340962624345752', '103.82403653115034', '-1', 'non-core'], ['2016-03-17 08:27', '1.3401394070868542', '103.83022271096706', '-1', 'non-core'], ['2016-03-17 08:28', '1.3376331170805915', '103.81688665598631', '-1', 'non-core'], ['2016-03-17 08:29', '1.332798861799561', '103.805649317801', '-1', 'non-core'], ['2016-03-17 08:37', '1.311565443899594', '103.80404376424849', '-1', 'non-core'], ['2016-03-17 08:38', '1.3040771566091702', '103.80164427682757', '-1', 'non-core'], ['2016-03-17 08:39', '1.2992078597075778', '103.8010007981211', '-1', 'non-core'], ['2016-03-17 08:40', '1.2974828789639554', '103.8000463321805', '-1', 'non-core'], ['2016-03-17 08:41', '1.2895883929749972', '103.80128603428602', '1', 'non-core'], ['2016-03-17 08:42', '1.2879219177600159', '103.80530379180398', '1', 'core']]
    #route_lst = [['2016-03-17 17:57', '1.2790144292445211', '103.81468903273344', '1', 'core'], ['2016-03-17 17:58', '1.2804304403653162', '103.81994348019361', '1', 'non-core'], ['2016-03-17 17:59', '1.2824019582917796', '103.8222735747695', '-1', 'non-core'], ['2016-03-17 18:00', '1.2824162970752555', '103.82236132398248', '-1', 'non-core'], ['2016-03-17 18:01', '1.284603468419647', '103.82533843070269', '-1', 'non-core'], ['2016-03-17 18:02', '1.287253182263161', '103.82368542999029', '-1', 'non-core'], ['2016-03-17 18:03', '1.2888254980127978', '103.82461857050657', '-1', 'non-core'], ['2016-03-17 18:04', '1.293568448760467', '103.82419370859861', '-1', 'non-core'], ['2016-03-17 18:05', '1.293504093363678', '103.82626162469387', '-1', 'non-core'], ['2016-03-17 18:06', '1.294406427219688', '103.8300359621644', '-1', 'non-core'], ['2016-03-17 18:07', '1.2960893066479438', '103.83304953575134', '-1', 'non-core'], ['2016-03-17 18:08', '1.296507400946291', '103.82865301519632', '-1', 'non-core'], ['2016-03-17 18:09', '1.2984240772466393', '103.83185254917903', '-1', 'non-core'], ['2016-03-17 18:10', '1.301491675596817', '103.83020712062716', '-1', 'non-core'], ['2016-03-17 18:11', '1.3018016140420583', '103.83086387068033', '-1', 'non-core'], ['2016-03-17 18:12', '1.3058616483122718', '103.83313458412886', '-1', 'non-core'], ['2016-03-17 18:13', '1.3048556349543643', '103.83619621396065', '-1', 'non-core'], ['2016-03-17 18:14', '1.3083664055475572', '103.83577224931547', '-1', 'non-core'], ['2016-03-17 18:28', '1.3132909934278258', '103.84112644940615', '-1', 'non-core'], ['2016-03-17 18:32', '1.319431439309975', '103.84355783994708', '-1', 'non-core'], ['2016-03-17 18:33', '1.3175586026883732', '103.8403944298625', '-1', 'non-core'], ['2016-03-17 18:34', '1.3245537329183574', '103.84246487170458', '-1', 'non-core'], ['2016-03-17 18:35', '1.3253311869535231', '103.83971793204546', '-1', 'non-core'], ['2016-03-17 18:36', '1.3235933114372902', '103.84182393550873', '-1', 'non-core'], ['2016-03-17 18:37', '1.328608593206857', '103.84021405130625', '-1', 'non-core'], ['2016-03-17 18:38', '1.3315707421121503', '103.85071378201246', '-1', 'non-core'], ['2016-03-17 18:39', '1.3374472069402417', '103.8377046212554', '-1', 'non-core'], ['2016-03-17 18:40', '1.3405376104202844', '103.83545993742618', '-1', 'non-core'], ['2016-03-17 18:41', '1.3484483934394191', '103.83757553994656', '-1', 'non-core'], ['2016-03-17 18:42', '1.346719518626874', '103.8372790440917', '-1', 'non-core'], ['2016-03-17 18:43', '1.3453709641387117', '103.84297493845224', '-1', 'non-core'], ['2016-03-17 18:45', '1.3530596181920955', '103.84971644729376', '-1', 'non-core'], ['2016-03-17 18:46', '1.3528351290170109', '103.84944648983387', '-1', 'non-core'], ['2016-03-17 18:47', '1.3606318300889138', '103.85250348597765', '-1', 'non-core'], ['2016-03-17 18:48', '1.3604447990430473', '103.85196637362242', '-1', 'non-core'], ['2016-03-17 18:49', '1.3658827794897999', '103.84948533028364', '-1', 'non-core'], ['2016-03-17 18:50', '1.3560914530469292', '103.8607519492507', '-1', 'non-core'], ['2016-03-17 18:51', '1.362644930185176', '103.85825145989656', '-1', 'non-core'], ['2016-03-17 18:52', '1.3776788466746293', '103.85876324600898', '-1', 'non-core'], ['2016-03-17 18:53', '1.3828160493804644', '103.8616132736206', '-1', 'non-core'], ['2016-03-17 18:54', '1.389738152181863', '103.85375174478843', '0', 'core']]
    
    ## CAF 18 (1- likely to be driving 2- bus or driving or walking 3- likely driving, 4&5 - bus or driving)
    #route_lst = [['2016-03-18 08:17', '1.3880628382205689', '103.85337347963026', '0', 'core'], ['2016-03-18 08:18', '1.3775774335033717', '103.85768260806799', '-1', 'non-core'], ['2016-03-18 08:19', '1.371398836908549', '103.86183924973011', '-1', 'non-core'], ['2016-03-18 08:20', '1.3620945621542', '103.8593826815486', '-1', 'non-core'], ['2016-03-18 08:21', '1.356866841193967', '103.85880779474974', '-1', 'non-core'], ['2016-03-18 08:22', '1.35106371769912', '103.85669510811567', '-1', 'non-core'], ['2016-03-18 08:23', '1.3549971528584457', '103.85901079326868', '-1', 'non-core'], ['2016-03-18 08:29', '1.3497891284453034', '103.84280394762754', '-1', 'non-core'], ['2016-03-18 08:30', '1.3482985904395632', '103.84318482130766', '-1', 'non-core'], ['2016-03-18 08:31', '1.3550765232662236', '103.84150441735983', '-1', 'non-core'], ['2016-03-18 08:32', '1.3503160666946463', '103.8407179553594', '-1', 'non-core'], ['2016-03-18 08:33', '1.3476797060365975', '103.83887853473425', '-1', 'non-core'], ['2016-03-18 08:34', '1.3447697521571662', '103.8376303575933', '-1', 'non-core'], ['2016-03-18 08:37', '1.3372303647733037', '103.81924498826265', '-1', 'non-core'], ['2016-03-18 08:38', '1.32480735596099', '103.81489539518952', '-1', 'non-core'], ['2016-03-18 08:39', '1.3196439158851598', '103.81351771205664', '-1', 'non-core'], ['2016-03-18 08:40', '1.3143761049599896', '103.80380988121033', '-1', 'non-core'], ['2016-03-18 08:41', '1.308331992741845', '103.80167338997126', '-1', 'non-core'], ['2016-03-18 08:42', '1.302714668149009', '103.80193818360567', '-1', 'non-core'], ['2016-03-18 08:43', '1.3001457758586572', '103.79947330802679', '-1', 'non-core'], ['2016-03-18 08:44', '1.2965489645218338', '103.79940245300531', '-1', 'non-core'], ['2016-03-18 08:45', '1.2903948617861454', '103.80093240941113', '1', 'non-core'], ['2016-03-18 08:46', '1.2947961422001606', '103.80497004836798', '1', 'non-core'], ['2016-03-18 08:47', '1.289220183955125', '103.80443997681141', '1', 'core']]
    #route_lst = [['2016-03-18 12:09', '1.2779932088830386', '103.80157012492418', '1', 'core'], ['2016-03-18 12:11', '1.2759856277203137', '103.79918720573187', '1', 'non-core'], ['2016-03-18 12:12', '1.2713215226840362', '103.80644392222166', '1', 'non-core'], ['2016-03-18 12:16', '1.275397561906384', '103.78737931698561', '2', 'non-core'], ['2016-03-18 12:17', '1.2763905407224598', '103.79211399704218', '2', 'core']]
    #route_lst = [['2016-03-18 17:55', '1.2833893597769288', '103.8129449263215', '1', 'core'], ['2016-03-18 17:56', '1.2785304105841175', '103.81603778153658', '1', 'non-core'], ['2016-03-18 17:57', '1.278345382849341', '103.81630144268274', '1', 'non-core'], ['2016-03-18 17:58', '1.281382973786291', '103.81905291229486', '-1', 'non-core'], ['2016-03-18 18:00', '1.2822409910985908', '103.81746087223291', '1', 'non-core'], ['2016-03-18 18:01', '1.290739435296893', '103.81900738924742', '-1', 'non-core'], ['2016-03-18 18:02', '1.283862406576434', '103.82232759825207', '-1', 'non-core'], ['2016-03-18 18:03', '1.2831218747736686', '103.82529348134995', '-1', 'non-core'], ['2016-03-18 18:04', '1.2803194454111544', '103.82274940609932', '-1', 'non-core'], ['2016-03-18 18:05', '1.2795022186321665', '103.8229462550953', '-1', 'non-core'], ['2016-03-18 18:06', '1.280796089272007', '103.82462047040462', '-1', 'non-core'], ['2016-03-18 18:07', '1.2806518248186562', '103.82736653308658', '-1', 'non-core'], ['2016-03-18 18:08', '1.2844978589029918', '103.83557752432192', '-1', 'non-core'], ['2016-03-18 18:09', '1.2899680966117866', '103.84114815294743', '-1', 'non-core'], ['2016-03-18 18:10', '1.2951965131631729', '103.84484980255365', '-1', 'non-core'], ['2016-03-18 18:11', '1.302624707548643', '103.84237613528967', '-1', 'non-core'], ['2016-03-18 18:12', '1.3150849192627643', '103.84578991681337', '-1', 'non-core'], ['2016-03-18 18:13', '1.3256459945535202', '103.84223129600286', '-1', 'non-core'], ['2016-03-18 18:16', '1.3489292719424446', '103.85858204215765', '-1', 'non-core'], ['2016-03-18 18:17', '1.3564889761439396', '103.86085018515587', '-1', 'non-core'], ['2016-03-18 18:18', '1.37465570988845', '103.8610527291894', '-1', 'non-core'], ['2016-03-18 18:19', '1.3791116611786236', '103.86254031211138', '-1', 'non-core'], ['2016-03-18 18:20', '1.3885618129423327', '103.85517045110464', '0', 'core']]
    #route_lst = [['2016-03-18 18:26', '1.3898134557338573', '103.848522529006', '0', 'core'], ['2016-03-18 18:27', '1.3882164463117375', '103.84406983852386', '0', 'non-core'], ['2016-03-18 18:28', '1.3865975369710821', '103.84154330939054', '0', 'non-core'], ['2016-03-18 18:29', '1.3878660733487536', '103.83803620934486', '-1', 'non-core'], ['2016-03-18 18:30', '1.3844856469449434', '103.83687137067318', '3', 'non-core'], ['2016-03-18 18:31', '1.3825125187218126', '103.83579171448946', '3', 'non-core'], ['2016-03-18 18:32', '1.3821890494159164', '103.82786314934492', '3', 'non-core'], ['2016-03-18 18:33', '1.3753335181403763', '103.8286923670343', '3', 'core'], ['2016-03-18 18:34', '1.369474910005945', '103.8289151340723', '3', 'core'], ['2016-03-18 18:35', '1.3674740480028436', '103.82854310330003', '3', 'core'], ['2016-03-18 18:36', '1.360079896739789', '103.82898297160864', '3', 'non-core'], ['2016-03-18 18:37', '1.353451559416342', '103.83146021515131', '-1', 'non-core'], ['2016-03-18 18:39', '1.3502659822242116', '103.83676830679178', '-1', 'non-core'], ['2016-03-18 18:40', '1.353765864139357', '103.83207693163838', '-1', 'non-core'], ['2016-03-18 18:41', '1.3539022353252168', '103.83410563958543', '-1', 'non-core'], ['2016-03-18 18:42', '1.3539234966679465', '103.83941229432821', '-1', 'non-core'], ['2016-03-18 18:43', '1.3565125773783813', '103.8314956203103', '-1', 'non-core'], ['2016-03-18 18:44', '1.363289546316409', '103.8262262865901', '3', 'non-core'], ['2016-03-18 18:45', '1.3687041063369696', '103.82886711508036', '3', 'core']]
    #route_lst = [['2016-03-18 18:54', '1.3728987750290789', '103.83140120655298', '3', 'core'], ['2016-03-18 18:55', '1.382357007558025', '103.8315493694466', '3', 'non-core'], ['2016-03-18 18:56', '1.3771099713368038', '103.83405458182096', '3', 'core'], ['2016-03-18 18:57', '1.3827428906497496', '103.83600416460207', '3', 'non-core'], ['2016-03-18 18:58', '1.3885683828965605', '103.84396936744452', '0', 'non-core'], ['2016-03-18 18:59', '1.3895625196651562', '103.8453272357583', '0', 'core']]

    ## ED7 14 (1- Car)
    #route_lst = [['2016-03-14 06:58', '1.3603416832986133', '103.93782016567208', '0', 'core'], ['2016-03-14 06:59', '1.3566933581325604', '103.93122190280872', '-1', 'non-core'], ['2016-03-14 07:00', '1.3557719460517796', '103.92891858919309', '-1', 'non-core'], ['2016-03-14 07:01', '1.3518572537820739', '103.92622239725745', '-1', 'non-core'], ['2016-03-14 07:02', '1.341368864209603', '103.91730811446905', '-1', 'non-core'], ['2016-03-14 07:03', '1.3386391247267475', '103.91124063637108', '1', 'non-core'], ['2016-03-14 07:04', '1.3377373895023243', '103.90245820031218', '1', 'non-core'], ['2016-03-14 07:05', '1.3369974862592149', '103.89943390552487', '1', 'core']]
    #route_lst = [['2016-03-14 07:17', '1.3316042602849258', '103.89070954173803', '1', 'core'], ['2016-03-14 07:18', '1.3305145720425489', '103.88782113790512', '1', 'non-core'], ['2016-03-14 07:19', '1.3378393729722817', '103.88836750388145', '-1', 'non-core'], ['2016-03-14 07:20', '1.340088998850973', '103.88303489238024', '-1', 'non-core'], ['2016-03-14 07:21', '1.3443221066693232', '103.87197457998991', '-1', 'non-core'], ['2016-03-14 07:22', '1.3442989502817209', '103.8666044814246', '2', 'non-core'], ['2016-03-14 07:23', '1.3437161813208847', '103.85838300647104', '2', 'core']]
    #route_lst = [['2016-03-14 14:40', '1.3523561796640005', '103.85744087398052', '2', 'core'], ['2016-03-14 14:42', '1.354297315318509', '103.8617924634706', '2', 'non-core'], ['2016-03-14 14:43', '1.3550549047759928', '103.8665212970227', '-1', 'non-core'], ['2016-03-14 14:44', '1.3557882278707123', '103.87179359793663', '-1', 'non-core'], ['2016-03-14 14:45', '1.356511908461116', '103.87213879823685', '-1', 'non-core'], ['2016-03-14 14:46', '1.3531454698777285', '103.8751097805798', '-1', 'non-core'], ['2016-03-14 14:47', '1.3521148470129627', '103.87289283424616', '-1', 'non-core'], ['2016-03-14 14:48', '1.3499447799219877', '103.87936398919139', '-1', 'non-core'], ['2016-03-14 14:49', '1.3437379480611973', '103.88050526912723', '-1', 'non-core'], ['2016-03-14 14:50', '1.3405351506193073', '103.89038871973753', '-1', 'non-core'], ['2016-03-14 14:51', '1.3373285528074799', '103.89731188304722', '1', 'non-core'], ['2016-03-14 14:52', '1.3370637573419801', '103.91124654561281', '1', 'non-core'], ['2016-03-14 14:53', '1.3391022149667073', '103.9161818638444', '-1', 'non-core'], ['2016-03-14 14:54', '1.3401658412967357', '103.92564694264105', '-1', 'non-core'], ['2016-03-14 14:55', '1.353808864155828', '103.93007732927799', '-1', 'non-core'], ['2016-03-14 14:56', '1.3595508024555478', '103.93898300081491', '0', 'core']]
    #route_lst = [['2016-03-14 17:29', '1.3594326945777757', '103.93372628837824', '0', 'core'], ['2016-03-14 17:30', '1.3544554440812715', '103.92870359982436', '-1', 'non-core'], ['2016-03-14 17:31', '1.3580918205708263', '103.9318665638566', '0', 'non-core'], ['2016-03-14 17:32', '1.3512733432553927', '103.92605723046205', '-1', 'non-core'], ['2016-03-14 17:33', '1.3413887925132741', '103.92331174761057', '-1', 'non-core'], ['2016-03-14 17:34', '1.3392752523549267', '103.91077504421656', '1', 'non-core'], ['2016-03-14 17:35', '1.337238201712811', '103.90336688607931', '1', 'core']]
    #route_lst = [['2016-03-14 18:15', '1.3368572833937404', '103.90825923532248', '1', 'core'], ['2016-03-14 18:16', '1.3385322310375185', '103.91111426394095', '1', 'non-core'], ['2016-03-14 18:17', '1.3403075361177603', '103.9200299307704', '-1', 'non-core'], ['2016-03-14 18:18', '1.3501472528873089', '103.92564814537764', '-1', 'non-core'], ['2016-03-14 18:19', '1.3522241163196949', '103.92700988799334', '-1', 'non-core'], ['2016-03-14 18:20', '1.3605637693093025', '103.93015938811004', '0', 'non-core'], ['2016-03-14 18:21', '1.3581891353788398', '103.93131678923965', '0', 'non-core'], ['2016-03-14 18:22', '1.3581647229476217', '103.93053975887597', '0', 'non-core'], ['2016-03-14 18:23', '1.3619110110355244', '103.93644236773252', '0', 'core'], ['2016-03-14 18:24', '1.3574728532738962', '103.94165273755789', '0', 'non-core'], ['2016-03-14 18:25', '1.3616226266530442', '103.94383245147765', '0', 'core']]
    
    ## ED7 15
    #route_lst = [['2016-03-15 07:31', '1.3588772958809032', '103.93385028732675', '0', 'core'], ['2016-03-15 07:32', '1.3564291011509406', '103.92939506918192', '0', 'non-core'], ['2016-03-15 07:33', '1.352457979709335', '103.92709935882262', '-1', 'non-core'], ['2016-03-15 07:34', '1.3498816388080772', '103.92890106886625', '-1', 'non-core'], ['2016-03-15 07:35', '1.3486812357171047', '103.92274919897318', '-1', 'non-core'], ['2016-03-15 07:36', '1.3382199517939541', '103.91377596450704', '-1', 'non-core'], ['2016-03-15 07:37', '1.3384505969513845', '103.90952781702464', '-1', 'non-core'], ['2016-03-15 07:38', '1.3371148271415776', '103.90585073354569', '-1', 'non-core'], ['2016-03-15 07:40', '1.3346659386367654', '103.89891173690557', '-1', 'non-core'], ['2016-03-15 07:41', '1.3310621537945626', '103.89638286083937', '-1', 'non-core'], ['2016-03-15 07:42', '1.3292043304676158', '103.89613498002291', '-1', 'non-core'], ['2016-03-15 07:43', '1.3294883766761527', '103.8945227808186', '-1', 'non-core'], ['2016-03-15 07:44', '1.3262975968130284', '103.89062773436308', '-1', 'non-core'], ['2016-03-15 07:45', '1.3315032579809727', '103.88900857418776', '-1', 'non-core'], ['2016-03-15 07:46', '1.3352848187403168', '103.88707548379898', '-1', 'non-core'], ['2016-03-15 07:47', '1.340063659570565', '103.88472167775035', '-1', 'non-core'], ['2016-03-15 07:48', '1.3418827715291672', '103.88063140958548', '-1', 'non-core'], ['2016-03-15 07:49', '1.3437312449855219', '103.87337274849415', '-1', 'non-core'], ['2016-03-15 07:50', '1.343931014201469', '103.87007691711187', '-1', 'non-core'], ['2016-03-15 07:51', '1.3436296842912472', '103.85939919389784', '1', 'core']]
    #route_lst = [['2016-03-15 12:00', '1.3221713531520258', '103.93323242132153', '2', 'core'], ['2016-03-15 12:01', '1.3288842941950276', '103.93521634116769', '2', 'non-core'], ['2016-03-15 12:02', '1.3294835398135598', '103.9320557937026', '2', 'non-core'], ['2016-03-15 12:03', '1.3304686507740764', '103.93416146188974', '-1', 'non-core'], ['2016-03-15 12:06', '1.3348114631472041', '103.93357384949923', '-1', 'non-core'], ['2016-03-15 12:07', '1.3355862615078218', '103.94412964096536', '-1', 'non-core'], ['2016-03-15 12:08', '1.3447103933887448', '103.9503475307272', '-1', 'non-core'], ['2016-03-15 12:09', '1.3511156226111067', '103.96001197929893', '-1', 'non-core'], ['2016-03-15 12:10', '1.353955669913392', '103.96445889025927', '-1', 'non-core'], ['2016-03-15 12:11', '1.3603337391721524', '103.96124985069036', '-1', 'non-core'], ['2016-03-15 12:12', '1.3664658961927696', '103.95398725888559', '0', 'core']]
    #route_lst = [['2016-03-15 14:19', '1.3598895860421236', '103.93611285835505', '0', 'core'], ['2016-03-15 14:20', '1.359695330042767', '103.93046148866415', '0', 'non-core'], ['2016-03-15 14:21', '1.3531149485247393', '103.92855764832348', '-1', 'non-core'], ['2016-03-15 14:22', '1.3441321201082828', '103.92405699938536', '-1', 'non-core'], ['2016-03-15 14:23', '1.3393910103456086', '103.92080540210009', '-1', 'non-core'], ['2016-03-15 14:24', '1.3389950883901522', '103.91801333986223', '-1', 'non-core'], ['2016-03-15 14:25', '1.3384165598545188', '103.91683157533407', '-1', 'non-core'], ['2016-03-15 14:26', '1.3346917613869052', '103.92292968928814', '-1', 'non-core'], ['2016-03-15 14:27', '1.3341782580686037', '103.9279717952013', '-1', 'non-core'], ['2016-03-15 14:28', '1.33811422609827', '103.92988488078117', '-1', 'non-core'], ['2016-03-15 14:29', '1.32959358801821', '103.92830338329077', '2', 'non-core'], ['2016-03-15 14:30', '1.3179889848066753', '103.93276255577803', '2', 'core']]
    #route_lst = [['2016-03-15 17:44', '1.3221350261986966', '103.93577557057142', '2', 'core'], ['2016-03-15 17:45', '1.3268826633388897', '103.93531241454184', '2', 'non-core'], ['2016-03-15 17:46', '1.3273420371012836', '103.92990466207266', '2', 'core'], ['2016-03-15 17:47', '1.3333719668703923', '103.93176849254154', '-1', 'non-core'], ['2016-03-15 17:48', '1.3335989859545636', '103.93361423164606', '-1', 'non-core'], ['2016-03-15 17:49', '1.3359878122619144', '103.94304358866066', '-1', 'non-core'], ['2016-03-15 17:50', '1.3431359581528624', '103.9495563134551', '-1', 'non-core'], ['2016-03-15 17:51', '1.3459024662846093', '103.95507499043431', '-1', 'non-core'], ['2016-03-15 17:52', '1.3532142479733031', '103.96568492799997', '-1', 'non-core'], ['2016-03-15 17:53', '1.3521164087148643', '103.96268762648106', '-1', 'non-core'], ['2016-03-15 17:54', '1.357878645834225', '103.96150667220354', '-1', 'non-core'], ['2016-03-15 17:55', '1.3570318791523122', '103.96428234343018', '-1', 'non-core'], ['2016-03-15 17:56', '1.3614546166149917', '103.96468184888363', '-1', 'non-core'], ['2016-03-15 17:57', '1.3635651142532126', '103.96420922130346', '-1', 'non-core'], ['2016-03-15 17:58', '1.3676569389913684', '103.95928337637868', '0', 'non-core'], ['2016-03-15 17:59', '1.3683899309364598', '103.9570846259594', '0', 'non-core'], ['2016-03-15 18:00', '1.3688117706594922', '103.95298732613975', '0', 'core']]
    #route_lst = [['2016-03-15 20:29', '1.3627157937478176', '103.93717517278024', '0', 'core'], ['2016-03-15 20:30', '1.358268261173093', '103.93248360604048', '0', 'non-core'], ['2016-03-15 20:31', '1.3547306967955384', '103.92922706902027', '-1', 'non-core'], ['2016-03-15 20:32', '1.3512281397820065', '103.92810587517239', '-1', 'non-core'], ['2016-03-15 20:33', '1.3461767420440627', '103.92445039004087', '-1', 'non-core'], ['2016-03-15 20:34', '1.338612846193057', '103.91175033152103', '-1', 'non-core'], ['2016-03-15 20:35', '1.3390125794389556', '103.9026302234693', '-1', 'non-core'], ['2016-03-15 20:36', '1.3393157951005172', '103.89242769777775', '-1', 'non-core'], ['2016-03-15 20:37', '1.341807508637878', '103.88492066413164', '-1', 'non-core'], ['2016-03-15 20:38', '1.3469272217653179', '103.87685442343354', '-1', 'non-core'], ['2016-03-15 20:39', '1.3399943417926776', '103.87196103483438', '-1', 'non-core'], ['2016-03-15 20:40', '1.3448385874504754', '103.8611621209062', '1', 'core'], ['2016-03-15 20:41', '1.3380010667885016', '103.86139343306422', '1', 'core'], ['2016-03-15 20:42', '1.3308467401537318', '103.8636362818735', '-1', 'non-core'], ['2016-03-15 20:43', '1.3326803383041468', '103.8576627150178', '-1', 'non-core'], ['2016-03-15 20:44', '1.3388375549230795', '103.85649997740984', '1', 'core']]
    #route_lst = [['2016-03-15 21:24', '1.3283714591701759', '103.84834767132998', '1', 'core'], ['2016-03-15 21:25', '1.3285078091345632', '103.85441981256008', '1', 'non-core'], ['2016-03-15 21:26', '1.3300404146818303', '103.86347103863955', '-1', 'non-core'], ['2016-03-15 21:27', '1.3242212588732303', '103.871483850692', '-1', 'non-core'], ['2016-03-15 21:28', '1.3202253543028564', '103.87457940727472', '-1', 'non-core'], ['2016-03-15 21:29', '1.3227674121169146', '103.88660598546267', '-1', 'non-core'], ['2016-03-15 21:30', '1.32263930957686', '103.8893900168213', '-1', 'non-core'], ['2016-03-15 21:31', '1.3235150110235367', '103.89356300979853', '-1', 'non-core'], ['2016-03-15 21:32', '1.324537465098473', '103.89776187390089', '-1', 'non-core'], ['2016-03-15 21:33', '1.3265912185581719', '103.90916261821985', '-1', 'non-core'], ['2016-03-15 21:34', '1.3337212864595427', '103.91969721087001', '-1', 'non-core'], ['2016-03-15 21:35', '1.3363079625137253', '103.92844525298902', '-1', 'non-core'], ['2016-03-15 21:36', '1.3370353336758687', '103.93178314715624', '-1', 'non-core'], ['2016-03-15 21:37', '1.3385704365056006', '103.93417907162355', '-1', 'non-core'], ['2016-03-15 21:38', '1.3412163556406047', '103.93701469525695', '-1', 'non-core'], ['2016-03-15 21:39', '1.3449410331894391', '103.94091608002782', '-1', 'non-core'], ['2016-03-15 21:40', '1.3504036299879996', '103.93712226301432', '-1', 'non-core'], ['2016-03-15 21:41', '1.3489174730448708', '103.9369638338685', '-1', 'non-core'], ['2016-03-15 21:42', '1.3528777269409313', '103.94031960517168', '-1', 'non-core'], ['2016-03-15 21:43', '1.3569937615190468', '103.93667093664408', '0', 'core'], ['2016-03-15 21:44', '1.3539795385735816', '103.93753635138273', '0', 'non-core'], ['2016-03-15 21:45', '1.3572518512559522', '103.94350815564394', '0', 'core']]

    ## ED7 16
    #route_lst = [['2016-03-16 07:21', '1.3612144942865276', '103.94340257414363', '0', 'core'], ['2016-03-16 07:22', '1.3605040588119137', '103.9365755841136', '0', 'non-core'], ['2016-03-16 07:23', '1.3605735087547597', '103.93026296049356', '-1', 'non-core'], ['2016-03-16 07:24', '1.3563057805047796', '103.92934695418391', '-1', 'non-core'], ['2016-03-16 07:26', '1.3391177692300502', '103.92243068665266', '-1', 'non-core'], ['2016-03-16 07:27', '1.3398236667922134', '103.90983000397682', '-1', 'non-core'], ['2016-03-16 07:29', '1.3372179416778103', '103.90532724559307', '-1', 'non-core'], ['2016-03-16 07:30', '1.3365033282797887', '103.90120837837458', '-1', 'non-core'], ['2016-03-16 07:55', '1.3319307313324031', '103.89630999416113', '1', 'core']]
    #route_lst = [['2016-03-16 17:44', '1.32977682819411', '103.89705497771502', '1', 'core'], ['2016-03-16 18:08', '1.3385602857744068', '103.89923641830683', '-1', 'non-core'], ['2016-03-16 18:09', '1.3348404752938539', '103.90190122649074', '-1', 'non-core'], ['2016-03-16 18:10', '1.334505813056912', '103.90671615089688', '-1', 'non-core'], ['2016-03-16 18:11', '1.3368351598516472', '103.90668670646846', '-1', 'non-core'], ['2016-03-16 18:12', '1.3378422106764314', '103.91068962617562', '-1', 'non-core'], ['2016-03-16 18:13', '1.3389808103891532', '103.91905519366264', '-1', 'non-core'], ['2016-03-16 18:15', '1.3596318658148316', '103.92804589122534', '-1', 'non-core'], ['2016-03-16 18:16', '1.356544616813669', '103.92858069390059', '-1', 'non-core'], ['2016-03-16 18:17', '1.3560713451349173', '103.93498040735722', '-1', 'non-core'], ['2016-03-16 18:18', '1.3564959088150224', '103.92939064651728', '-1', 'non-core'], ['2016-03-16 18:19', '1.3588071002135316', '103.93999546766281', '0', 'non-core'], ['2016-03-16 18:20', '1.3632218406133765', '103.93822386860847', '0', 'non-core'], ['2016-03-16 18:21', '1.3621968471205974', '103.94514896906912', '0', 'core']]

    ## ED7 17
    #route_lst = [['2016-03-17 07:29', '1.3607917782513006', '103.93864955753088', '0', 'core'], ['2016-03-17 07:30', '1.3713938071921583', '103.93587190657854', '0', 'non-core'], ['2016-03-17 07:31', '1.3550192055263404', '103.92848582938313', '-1', 'non-core'], ['2016-03-17 07:32', '1.3502519045013486', '103.9251159131527', '-1', 'non-core'], ['2016-03-17 07:33', '1.350194923375228', '103.92608184367418', '-1', 'non-core'], ['2016-03-17 07:34', '1.3507566896633734', '103.92643008381128', '-1', 'non-core'], ['2016-03-17 07:35', '1.338702139531328', '103.9146448461258', '-1', 'non-core'], ['2016-03-17 07:36', '1.338160481172398', '103.90792429447174', '1', 'non-core'], ['2016-03-17 07:37', '1.3368201896435035', '103.90345718711615', '1', 'core']]
    #route_lst = [['2016-03-17 17:15', '1.3608632158975096', '103.93722575157881', '0', 'core'], ['2016-03-17 17:16', '1.3593580057552876', '103.93470554798841', '0', 'non-core'], ['2016-03-17 17:17', '1.3599969963587664', '103.93306966871023', '0', 'non-core'], ['2016-03-17 17:18', '1.3553918269587462', '103.92816816840102', '-1', 'non-core'], ['2016-03-17 17:19', '1.3493491110867235', '103.92701558768749', '-1', 'non-core'], ['2016-03-17 17:20', '1.3401233185343266', '103.9158717636019', '-1', 'non-core'], ['2016-03-17 17:21', '1.3396170201517468', '103.90905660577118', '-1', 'non-core'], ['2016-03-17 17:22', '1.3369400736249162', '103.90681369230151', '1', 'non-core'], ['2016-03-17 17:23', '1.3354760532066217', '103.90343260020018', '1', 'non-core'], ['2016-03-17 17:24', '1.3365167356763767', '103.8944673165679', '1', 'core']]
    #route_lst = [['2016-03-17 18:14', '1.3321901648680485', '103.89504510909319', '1', 'core'], ['2016-03-17 18:15', '1.33688878979038', '103.89876783639193', '1', 'non-core'], ['2016-03-17 18:16', '1.3390905702536702', '103.90499757336718', '1', 'non-core'], ['2016-03-17 18:17', '1.3365433563347044', '103.90457110213381', '1', 'non-core'], ['2016-03-17 18:18', '1.3372916828966024', '103.89686536043882', '1', 'non-core'], ['2016-03-17 18:19', '1.3385703441965846', '103.90550346672535', '1', 'non-core'], ['2016-03-17 18:20', '1.338774857697777', '103.91272907278368', '-1', 'non-core'], ['2016-03-17 18:21', '1.3392354615967494', '103.91881257827792', '-1', 'non-core'], ['2016-03-17 18:22', '1.3533349159456438', '103.93243666738272', '-1', 'non-core'], ['2016-03-17 18:23', '1.3560307208543645', '103.92841134220362', '-1', 'non-core'], ['2016-03-17 18:24', '1.3556483434375968', '103.93064984679222', '-1', 'non-core'], ['2016-03-17 18:25', '1.3638500701351257', '103.93144332803786', '-1', 'non-core'], ['2016-03-17 18:26', '1.352649800832012', '103.92964985221624', '-1', 'non-core'], ['2016-03-17 18:27', '1.3568090777082262', '103.93157701939344', '-1', 'non-core'], ['2016-03-17 18:28', '1.3604398823449324', '103.93528643995523', '0', 'non-core'], ['2016-03-17 18:29', '1.361614355753251', '103.93953960388899', '0', 'core']]
    
    ## ED7 18
    #route_lst = [['2016-03-18 07:26', '1.3579811151309922', '103.93020657024213', '0', 'core'], ['2016-03-18 07:27', '1.3531362192013612', '103.92899968475103', '0', 'non-core'], ['2016-03-18 07:28', '1.3410572396181948', '103.91750279814005', '1', 'non-core'], ['2016-03-18 07:29', '1.3385110848714372', '103.9113648980856', '1', 'non-core'], ['2016-03-18 07:30', '1.3380292353814598', '103.9028986915946', '1', 'core'], ['2016-03-18 07:31', '1.3362771900751367', '103.90331447124481', '1', 'core'], ['2016-03-18 07:32', '1.3363676452687394', '103.90187960118055', '1', 'core'], ['2016-03-18 07:41', '1.3387524178350638', '103.88629982247949', '1', 'non-core'], ['2016-03-18 07:42', '1.343053332170537', '103.88114696368575', '-1', 'non-core'], ['2016-03-18 07:43', '1.344570545555122', '103.87773837894201', '-1', 'non-core'], ['2016-03-18 07:44', '1.3443675574618479', '103.86888615041971', '2', 'non-core'], ['2016-03-18 07:45', '1.3431069351658795', '103.85873962193727', '2', 'core']]
    #route_lst = [['2016-03-18 10:15', '1.3438492298852258', '103.84398680180311', '2', 'core'], ['2016-03-18 10:18', '1.3339445227537954', '103.81460471078753', '-1', 'non-core'], ['2016-03-18 10:23', '1.2985158603444726', '103.80011592060328', '-1', 'non-core'], ['2016-03-18 10:24', '1.2897459317146243', '103.79731759428978', '-1', 'non-core'], ['2016-03-18 10:33', '1.2711467729541166', '103.79665419459343', '3', 'non-core'], ['2016-03-18 10:34', '1.2783614745255827', '103.79227448254824', '3', 'non-core'], ['2016-03-18 10:35', '1.2708343767207737', '103.80955461412668', '-1', 'non-core'], ['2016-03-18 10:36', '1.2708343767207737', '103.80955461412668', '-1', 'non-core'], ['2016-03-18 10:37', '1.2754868605049443', '103.79751350730658', '3', 'core']]
    #route_lst = [['2016-03-18 10:51', '1.274655997079477', '103.79913754295558', '3', 'core'], ['2016-03-18 10:52', '1.2733641906218849', '103.80564160645008', '3', 'non-core'], ['2016-03-18 10:53', '1.2774966766151667', '103.80174603313208', '3', 'non-core'], ['2016-03-18 10:54', '1.281447924087644', '103.79688553512096', '-1', 'non-core'], ['2016-03-18 10:55', '1.2851947761471614', '103.80356218665838', '-1', 'non-core'], ['2016-03-18 10:56', '1.2912301531042603', '103.79790846258402', '-1', 'non-core'], ['2016-03-18 10:57', '1.2891050477231993', '103.80123306065798', '-1', 'non-core'], ['2016-03-18 10:58', '1.2951237340681987', '103.79913001720395', '-1', 'non-core'], ['2016-03-18 10:59', '1.3013227386351816', '103.8018237054348', '-1', 'non-core'], ['2016-03-18 11:00', '1.3112934384598622', '103.80174779333174', '-1', 'non-core'], ['2016-03-18 11:04', '1.337595045456556', '103.820816449821', '-1', 'non-core'], ['2016-03-18 11:09', '1.344395173911071', '103.85055258125067', '2', 'core']]
    #route_lst = [['2016-03-18 13:34', '1.3429817737563854', '103.86119518429041', '2', 'core'], ['2016-03-18 13:35', '1.3464690259059102', '103.87553460896015', '-1', 'non-core'], ['2016-03-18 13:36', '1.3432088734187546', '103.88369494619278', '-1', 'non-core'], ['2016-03-18 13:37', '1.3401742688689013', '103.89569162306461', '1', 'core'], ['2016-03-18 13:38', '1.3363300885875526', '103.90225546336488', '1', 'core'], ['2016-03-18 13:39', '1.3392174844251603', '103.91086877323687', '1', 'non-core'], ['2016-03-18 13:40', '1.3407406111269156', '103.91998770701535', '-1', 'non-core'], ['2016-03-18 13:41', '1.3611768320179207', '103.92557915300131', '0', 'non-core'], ['2016-03-18 13:42', '1.3576277393138543', '103.93108560038465', '0', 'core']]

    # print(float(route_lst[0][1]))
    # print(float(route_lst[0][2]))
    # print(float(route_lst[-1][1]))
    # print(float(route_lst[-1][2]))

    #process("lat_long_kdtree.pickle", "descriptions_list.pickle", route, "query", 3)
    # query_kdtree_output = process("lat_long_kdtree.pickle", "descriptions_list.pickle", route_lst, "query_ballpoint", 0.0025) #stores a list of tuples
    # print("Length of route: " + str(len(query_kdtree_output[1])))
    # get_route_type_by_time(query_kdtree_output)
